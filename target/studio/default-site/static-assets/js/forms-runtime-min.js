Alfresco.forms=Alfresco.forms||{};Alfresco.forms.validation=Alfresco.forms.validation||{};(function(){var d=YAHOO.util.Dom,b=YAHOO.util.Event,a=YAHOO.util.Selector,c=YAHOO.util.KeyListener;Alfresco.forms.Form=function(e){this.formId=e;this.showSubmitStateDynamically=false;this.reusable=true;this.submitAsJSON=false;this.submitElements=[];this.validations=[];this.tooltips={};this._valid=null;this._fieldEvents={};this._visitedFields={};this.ajaxSubmit=false;this.ajaxSubmitMethod="POST";this.ajaxNoReloadOnAuthFailure=null;this.errorContainer="tooltip";this.showMultipleErrors=false;YAHOO.Bubbling.on("showPanel",this.hideErrorContainer,this);YAHOO.Bubbling.on("hidePanel",this.hideErrorContainer,this);YAHOO.Bubbling.on("showOverlay",this.hideErrorContainer,this);YAHOO.Bubbling.on("hideOverlay",this.hideErrorContainer,this);return this};YAHOO.lang.augmentObject(Alfresco.forms.Form,{NOTIFICATION_LEVEL_NONE:1,NOTIFICATION_LEVEL_FIELD:2,NOTIFICATION_LEVEL_CONTAINER:3});Alfresco.forms.Form.prototype={formId:null,submitElements:null,showSubmitStateDynamically:null,reusable:false,ajaxSubmit:null,errorContainer:null,showMultipleErrors:false,doBeforeFormSubmit:{fn:function(e,f){},obj:null,scope:this},doBeforeAjaxRequest:{fn:function(e,f){return true},obj:null,scope:this},ajaxSubmitHandlers:null,ajaxSubmitMethod:null,ajaxNoReloadOnAuthFailure:null,submitAsJSON:null,validations:null,tooltips:null,_fieldEvents:{},_FIELD_EVENT_UNDEFINED:undefined,_FIELD_EVENT_LISTEN:1,_FIELD_EVENT_VALIDATE:2,_VALIDATION_MSG_ATTR:"alf-validation-msg",_visitedFields:null,_valid:null,init:function(){var i=d.get(this.formId);if(i!==null){if(i.getAttribute("forms-runtime")!="listening"){b.addListener(i,"submit",this._submitInvoked,this,true);i.setAttribute("forms-runtime","listening");if(this.ajaxSubmit){i.setAttribute("onsubmit","return false;")}}if(i.getAttribute("enctype")&&i.getAttribute("enctype")=="application/json"){this.ajaxSubmit=true;this.submitAsJSON=true}if(this.submitElements&&this.submitElements.length==0){var g=a.query("#"+this.formId+' > input[type="submit"]');for(var e=0,j=g.length;e<j;e++){var h=g[e];this.submitElements.push(h.id)}}this._runValidations(null,null,Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD);var f=new c(document,{keys:c.KEY.ESCAPE},{fn:function(l,k){for(var l in this.tooltips){if(this.tooltips.hasOwnProperty(l)){this.tooltips[l].hide()}}},scope:this,correctScope:true});f.enable()}else{this._showInternalError("form with id of '"+this.formId+"' could not be located, ensure the form is created after the form element is available.")}},isValid:function(){return this._valid},setValidateOnSubmit:function(e){},setValidateAllOnSubmit:function(e){},setSubmitElements:function(e){if(!YAHOO.lang.isArray(e)){this.submitElements[0]=e}else{this.submitElements=e}},setErrorContainer:function(e){this.errorContainer=e},setShowMultipleErrors:function(e){this.showMultipleErrors=e},setRepeatable:function(f,e){alert("not implemented yet")},setShowSubmitStateDynamically:function(e){this.showSubmitStateDynamically=e},setAsReusable:function(e){this.reusable=e},setAJAXSubmit:function(f,e){this.ajaxSubmit=f;this.ajaxSubmitHandlers=e},setSubmitAsJSON:function(e){this.submitAsJSON=e},setAjaxSubmitMethod:function(e){this.ajaxSubmitMethod=e},setAjaxNoReloadOnAuthFailure:function(e){this.ajaxNoReloadOnAuthFailure=e},addValidation:function(i,m,k,j,n,e){var l=d.get(i);if(l==null){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Ignoring validation for field with id of '"+i+"' as it could not be located.")}return}else{if(!l.id){Alfresco.util.generateDomId(l,"form-field-")}}if(m===undefined||m===null){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Ignoring validation for field with id of '"+i+"' as a validationHandler was not provided.")}return}if(n===undefined){n=null}var f={fieldId:l.id,args:k,handler:m,message:n,originalTitle:l.getAttribute("title")||"",event:j,config:e};this.validations.push(f);if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Added submit validation for field: "+i+", using handler: "+(m.name||YAHOO.lang.dump(m))+", args: "+YAHOO.lang.dump(k))}if(j&&j.length>0){if(this._fieldEvents[l.id+":blur"]==this._FIELD_EVENT_UNDEFINED){b.addListener(l,"blur",this._validationEventFired,l.id,this);this._fieldEvents[l.id+":blur"]=this._FIELD_EVENT_LISTEN}if(this._fieldEvents[l.id+":"+j]==this._FIELD_EVENT_UNDEFINED){if(YAHOO.env.ua.ie>0&&j=="propertychange"){var h=this,g=l.id;l.attachEvent("onpropertychange",function(o){h._validationEventFired(o,g)})}else{b.addListener(l,j,this._validationEventFired,l.id,this)}}if(this._fieldEvents[l.id+":"+j]!=this._FIELD_EVENT_VALIDATE){this._fieldEvents[l.id+":"+j]=this._FIELD_EVENT_VALIDATE}if(this._fieldEvents[l.id+":focus"]==this._FIELD_EVENT_UNDEFINED){b.addListener(l,"focus",this._validationEventFired,l.id,this);this._fieldEvents[l.id+":focus"]=this._FIELD_EVENT_LISTEN}if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Added field validation for field: "+i+", using handler: "+(m.name||YAHOO.lang.dump(m))+", args: "+YAHOO.lang.dump(k)+", on event: "+j)}}},addError:function(f,e){},addSubmitElement:function(e){if(e!==null){this.submitElements.push(e);if(this.showSubmitStateDynamically){this.validate()}}},getFieldLabel:function(g){var h=null;var f=a.query("label");if(f.length>0){for(var e=0,j=f.length;e<j;e++){var i=f[e];if((i.htmlFor==g)||(i.htmlFor==g+"-cntrl")){h=i.firstChild.nodeValue}}}if(h==null){h=g}return h},getFormData:function(){var e=d.get(this.formId);return this._buildAjaxForSubmit(e)},applyTabFix:function(){if(YAHOO.env.ua.gecko>0){var g=d.get(this.formId);var f=function(l,j){var i=j[1];var k=i.target;if(!k.hasAttribute("tabindex")){b.stopEvent(i);var h=a.query("[tabindex]",g)[0];if(Alfresco.util.isVisible(h)){h.focus()}}};var e=new c(g,{keys:c.KEY.TAB},f,"keyup");e.enable()}},updateSubmitElements:function(){return this.validate(Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD)},validate:function(e){e=e||Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD;return this._runValidations({},false,e)},validateField:function(f,e){this._validationEventFired(f,e)},_toggleSubmitElements:function(f){for(var e=0,h=this.submitElements.length;e<h;e++){var g=this.submitElements[e];if(g){if(typeof g=="string"){d.get(g).disabled=!f}else{g.set("disabled",!f)}}}},_validationEventFired:function(g,e){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Event has been fired for field: "+e)}if(g){if(g.type=="blur"){if(!this._isFieldVisited(e)){this._setFieldAsVisited(e);this._runValidations(g,e,Alfresco.forms.Form.NOTIFICATION_LEVEL_CONTAINER)}this._setFieldAsVisited(e);if(this.tooltips[e]){this.hideErrorContainer()}}else{if(g.type=="focus"){if(!this.tooltips[e]){this.tooltips[e]=Alfresco.util.createBalloon(this.getFieldValidationEl(e),{effectType:null,effectDuration:0})}if(YAHOO.util.Dom.hasClass(e,"invalid")){if(this._fieldEvents[e+":focus"]!=this._FIELD_EVENT_VALIDATE){var f=d.get(e).getAttribute(this._VALIDATION_MSG_ATTR);this.tooltips[e].html(f);this.tooltips[e].show()}}}else{if(g.type=="propertychange"&&!Alfresco.util.arrayContains(["value","checked"],g.propertyName)){return}}}}if(!g||(g.keyCode!=9&&g.keyCode!=16&&g.keyCode!=13&&g.keyCode!=27)){if(g&&this._fieldEvents[e+":"+g.type]==this._FIELD_EVENT_VALIDATE){this._runValidations(g,e,Alfresco.forms.Form.NOTIFICATION_LEVEL_CONTAINER)}}},_setCSRFParameter:function(f){var e=f.split("?"),h=Alfresco.util.CSRFPolicy.getParameter()+"="+encodeURIComponent(Alfresco.util.CSRFPolicy.getToken());if(e.length==1){f+="?"+h}else{var k=e[1].split("&"),j=0,i,l="",g=true;for(;j<k.length;j++){i=k[j].split("=");if(i.length>0&&i[0]==Alfresco.util.CSRFPolicy.getParameter()){}else{l+=g?"?":"&";l+=k[j];g=false}}if(j==k.length){l+=g?"?":"&";l+=h}f=e[0]+l}return f},_submitInvoked:function(i){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Submit invoked on formId: ",this.formId)}this._setAllFieldsAsVisited();if(this._runValidations(i,null,Alfresco.forms.Form.NOTIFICATION_LEVEL_CONTAINER)){var h=d.get(this.formId);this.doBeforeFormSubmit.fn.call(this.doBeforeFormSubmit.scope,h,this.doBeforeFormSubmit.obj);if(this.ajaxSubmit){b.stopEvent(i);var k=h.attributes.action.nodeValue;if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Performing AJAX submission to url: ",k)}if(h.enctype&&h.enctype=="multipart/form-data"){var j=h.ownerDocument;var g=j.createElement("iframe");g.style.display="none";d.generateId(g,"formAjaxSubmit");g.name=g.id;document.body.appendChild(g);window.frames[g.name].name=g.name;if(Alfresco.util.CSRFPolicy.isFilterEnabled()){h.attributes.action.nodeValue=this._setCSRFParameter(k)}h.target=g.name;h.submit();return}else{this._toggleSubmitElements(false)}var e={method:this.ajaxSubmitMethod,url:k};if(this.ajaxSubmitHandlers){this.ajaxSubmitHandlers=this.ajaxSubmitHandlers||{};e.successMessage=this.ajaxSubmitHandlers.successMessage;e.successCallback={fn:function(m,l){if(d.get(this.formId)){this._resetAllVisitedFields();if(this.reusable){if(this.showSubmitStateDynamically){this.updateSubmitElements()}else{this._toggleSubmitElements(true)}}}if(l.fn){l.fn.call(l.scope||this,m,l.obj)}},obj:this.ajaxSubmitHandlers.successCallback||{},scope:this};e.failureMessage=this.ajaxSubmitHandlers.failureMessage;e.failureCallback={fn:function(l,m){if(d.get(this.formId)){this._resetAllVisitedFields();if(this.showSubmitStateDynamically){this.updateSubmitElements()}else{this._toggleSubmitElements(true)}}if(m.fn){m.fn.call(m.scope||this,l,m.obj)}},obj:this.ajaxSubmitHandlers.failureCallback||{},scope:this}}if(this.submitAsJSON){var f=this._buildAjaxForSubmit(h);e.dataObj=f;e.noReloadOnAuthFailure=this.ajaxNoReloadOnAuthFailure;if(this.doBeforeAjaxRequest.fn.call(this.doBeforeAjaxRequest.scope,e,this.doBeforeAjaxRequest.obj)){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Submitting JSON data: ",e.dataObj)}Alfresco.util.Ajax.jsonRequest(e)}else{if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("JSON data request cancelled in doBeforeAjaxRequest()")}}}else{if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Submitting data in form: ",h.enctype)}e.dataForm=h;Alfresco.util.Ajax.request(e)}}else{if(h.enctype&&h.enctype=="multipart/form-data"&&Alfresco.util.CSRFPolicy.isFilterEnabled()){h.attributes.action.nodeValue=this._setCSRFParameter(h.attributes.action.nodeValue)}}}else{b.stopEvent(i);if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Submission prevented as validation failed")}}},_buildAjaxForSubmit:function(f){if(f!==null){var h={},g=f.elements.length;for(var o=0;o<g;o++){var p=f.elements[o],e=p.name;if(e=="-"||p.disabled||p.type==="button"){continue}if(e==undefined||e==""){e=p.id}var t=(p.type==="textarea")?p.value:YAHOO.lang.trim(p.value);if(e){if((e.length>2)&&(e.substring(e.length-2)=="[]")){e=e.substring(0,e.length-2);if(h[e]===undefined){h[e]=new Array()}h[e].push(t)}else{if(e.indexOf(".")>0){var s=e.split(".");var n=h;var r;for(var m=0,l=s.length-1;m<l;m++){r=s[m];if(n[r]===undefined){n[r]={}}n=n[r]}n[s[m]]=t}else{if(!((p.type==="checkbox"||p.type==="radio")&&!p.checked)){if(p.type=="select-multiple"){for(var m=0,q=p.options.length;m<q;m++){if(p.options[m].selected){if(h[e]==undefined){h[e]=new Array()}h[e].push(p.options[m].value)}}}else{h[e]=t}}}}}}return h}},_isFieldVisited:function(e){return(YAHOO.lang.isBoolean(this._visitedFields)&&this._visitedFields)||(YAHOO.lang.isObject(this._visitedFields)&&this._visitedFields[e])},_setFieldAsVisited:function(e){if(!YAHOO.lang.isBoolean(this._visitedFields)&&YAHOO.lang.isObject(this._visitedFields)){return this._visitedFields[e]=true}},_setAllFieldsAsVisited:function(){this._visitedFields=true},_resetAllVisitedFields:function(){this._visitedFields={}},_getConfig:function(g,h,f){var i=g||{};if(YAHOO.lang.isFunction(g)){i=g()}var e=Alfresco.util.findValueByDotNotation(i,h);return(e!=undefined||e!=null)?e:f},_isMandatoryValidator:function(e){return e.handler==Alfresco.forms.validation.mandatory||(this._getConfig(e.config,"validationType","invalid")=="mandatory")},_runValidations:function(y,w,e){var r=[],F={},B={},s=[],m={},t,q,u,l,D="mandatory",C="invalid",g,h,I,v,G=null;for(var o=0,k=this.validations.length;o<k;o++){I=this.validations[o];g=d.get(I.fieldId);if(g!==null&&!g.disabled){u=null;h=g.getAttribute("id");F[h]=F[h]||[];B[h]=B[h]||[];m[h]=m[h]||[];l=this._isMandatoryValidator(I)&&!this._isFieldVisited(h)?D:C;if(typeof I.message==="object"&&I.message!=null){q=I.message.html||null;u=I.message.text||null}else{q=I.message||null}if(q){if(YAHOO.lang.isFunction(q)){q=q.call(this,I.args)}else{q=YAHOO.lang.substitute(q,I.args)}}else{var H;if(this._isMandatoryValidator(I)){H="Alfresco.forms.validation.mandatory.message"}else{H="Alfresco.forms.validation.invalid.message"}q=Alfresco.util.message(H)}if(u){if(YAHOO.lang.isFunction(u)){u=u.call(this,I.args)}else{u=YAHOO.lang.substitute(u,I.args)}}else{u=q.replace(/<\/?[^>]+(>|$)/g,"")}v=(l==C)&&(y!=null&&y.type!="blur"&&y.type!=I.event&&y.keyCode!=13)&&(w==h);if(!I.handler(g,I.args,null,this,true,q)){var A=d.get(this._getConfig(I.config,"errorField",g));if(!A.id){Alfresco.util.generateDomId(A)}if(A.id!=w&&l==C){F[A.id]=F[A.id]||[];B[A.id]=B[A.id]||[];F[A.id].push(q);B[A.id].push(u)}if(G==null){G=A.id}if(v){continue}t=YAHOO.lang.trim(this.getFieldLabel(h))||"";if(t.length>0){if(t.indexOf(":")<0){t+=":"}t+=" "}t+=q;if(l==C){if(e>=Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD){YAHOO.util.Dom.removeClass(g,D);if(g==A){YAHOO.util.Dom.addClass(g,C)}else{YAHOO.util.Dom.removeClass(g,C)}if(F[h].length==0){g.setAttribute("title",u);g.setAttribute(this._VALIDATION_MSG_ATTR,q)}else{g.setAttribute("title",B[h][0]);g.setAttribute(this._VALIDATION_MSG_ATTR,F[h][0])}}r.push({id:h,msg:t});F[h].push(q);B[h].push(u)}else{if(F[h].length==0){if(e>=Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD){YAHOO.util.Dom.removeClass(g,C);if(g==A){YAHOO.util.Dom.addClass(g,D)}else{YAHOO.util.Dom.removeClass(g,C)}g.setAttribute("title",q)}g.setAttribute(this._VALIDATION_MSG_ATTR,q)}m[h].push(q);s.push({id:h,msg:t})}YAHOO.Bubbling.fire("formValidationError",{msg:t,field:g,type:l})}else{if(v){continue}if(e>=Alfresco.forms.Form.NOTIFICATION_LEVEL_FIELD){if(F[h].length==0){YAHOO.util.Dom.removeClass(g,C)}if(m[h].length==0){YAHOO.util.Dom.removeClass(g,D)}if(F[h].length==0&&m[h].length==0){g.setAttribute("title",I.originalTitle);g.setAttribute(this._VALIDATION_MSG_ATTR,"");if(this.tooltips[h]){this.tooltips[h].html("");this.tooltips[h].hide()}}}}}}var E=(document.activeElement&&document.activeElement.id?document.activeElement.id:null);if(e>=Alfresco.forms.Form.NOTIFICATION_LEVEL_CONTAINER){if((y==null||y.type=="submit")&&G&&(!m[E]||m[E].length==0)&&(!F[E]||F[E].length==0)){E=G;var f=this.getFieldValidationEl(d.get(E));if(Alfresco.util.isVisible(f)){if(YAHOO.env.ua.ie>0&&YAHOO.env.ua.ie<9){}else{if(YAHOO.lang.isFunction(f.focus)){f.focus()}}}}if(this.errorContainer!==null&&E&&F[E]){if(this.errorContainer==="tooltip"){if(F[E].length>0){if(!this.tooltips[E]){this.tooltips[E]=Alfresco.util.createBalloon(this.getFieldValidationEl(E),{effectType:null,effectDuration:0})}var p="";for(var z=0;z<F[E].length;z++){if(z>0&&!this.showMultipleErrors){break}p+="<div>"+F[E][z]+"</div>"}this.tooltips[E].html(p);this.tooltips[E].show()}else{if(this.tooltips[E]){this.tooltips[E].html("");this.tooltips[E].hide()}}}else{if(this.errorContainer==="alert"&&r.length>0){var j="";for(var z=0;z<r.length;z++){if(z>0&&!this.showMultipleErrors){break}j+=r[z]+"\n"}alert(j)}else{if(YAHOO.lang.isString(this.errorContainer)){var n=d.get(this.errorContainer);if(n!==null){var p="";for(var z=0;z<r.length;z++){if(z>0&&!this.showMultipleErrors){break}p+='<div><label for="'+r[z].id+'">'+r[z].msg+"</label></div>"}n.style.display="block";n.innerHTML=p}}}}}}this._valid=G==null;if(this.showSubmitStateDynamically){this._toggleSubmitElements(this._valid)}return this._valid},getFieldValidationEl:function(e){var f=d.get(e);if((f.tagName.toLowerCase()=="input"&&f.type=="hidden")||!Alfresco.util.isVisible(f)){return f.parentNode}return f},hideErrorContainer:function(){if(this.errorContainer==="tooltip"){for(var e in this.tooltips){if(this.tooltips.hasOwnProperty(e)){this.tooltips[e].hide()}}}else{if(this.errorContainer==="alert"){}else{if(YAHOO.lang.isString(this.errorContainer)){}}}},_showInternalError:function(f,e){this.addError("Internal Form Error: "+f,e)},reset:function(){this._resetAllVisitedFields();d.get(this.formId).reset();this.validate()}}})();(function(){Alfresco.forms.validation.mandatory=function g(A,y,u,v){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating mandatory state of field '"+A.id+"'")}var r=true;if(A.type&&A.type=="radio"){var t=Dom.get(v.formId),w=t[A.name],s=false;for(var z=0,q=w.length;z<q;z++){if(w[z].checked){s=true;break}}r=s}else{if(A.type&&A.type=="checkbox"){r=A.checked}else{r=YAHOO.lang.trim(A.value).length!==0}}return r};Alfresco.forms.validation.passwordMatch=function p(w,r,v,u){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating password match of field '"+w.id+"' using args: "+YAHOO.lang.dump(r))}if(YAHOO.lang.trim(w.value).length==0){return true}var t=false;var q=YAHOO.lang.merge({el:null},r);if(q.el){var s=YAHOO.util.Dom.get(q.el);if(s.value==w.value){t=true}}return t};Alfresco.forms.validation.passwordContent=function j(y,x,r,t){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating password content of field '"+y.id+"' using args: "+YAHOO.lang.dump(x))}if(YAHOO.lang.trim(y.value).length==0){return true}var D=YAHOO.lang.merge({minUpper:0,minLower:0,minNumeric:0,minSymbols:0},x),C=y.value,B=/\d/g,w=/([!,@,#,$,%,^,&,*,?,_,~])/g,z=(C.match(B)||[]).length,s=(C.match(w)||[]).length,A=0,v=0,q;for(var u=0;u<C.length;u++){q=C.charAt(u);if(q.toUpperCase()!=q.toLowerCase()){if(q.toUpperCase()==q){A++}if(q.toLowerCase()==q){v++}}}return D.minUpper<=A&&D.minLower<=v&&D.minNumeric<=z&&D.minSymbols<=s};Alfresco.forms.validation.length=function c(w,r,v,u){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating length of field '"+w.id+"' using args: "+YAHOO.lang.dump(r))}var t=true;var q=YAHOO.lang.merge({min:-1,max:-1,crop:false,includeWhitespace:true,ignoreEmpty:false},r);if(YAHOO.lang.trim(w.value).length==0&&q.ignoreEmpty){return true}if(q.minLength){q.min=q.minLength}if(q.maxLength){q.max=q.maxLength}var s=q.includeWhitespace?w.value.length:YAHOO.lang.trim(w.value).length;if(q.min!=-1&&s<q.min){t=false}if(q.max!=-1&&s>q.max){t=false;if(q.crop){if(q.includeWhitespace){w.value=YAHOO.lang.trim(w.value)}if(w.value.length>q.max){w.value=w.value.substring(0,q.max)}if(w.type&&w.type=="textarea"){w.scrollTop=w.scrollHeight}t=true}}return t};Alfresco.forms.validation.number=function e(w,r,v,u){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+w.id+"' is a number")}var x=false;if(r!==null&&r.repeating){x=true}var t=true;if(x){var q=w.value.split(",");for(var s=0;s<q.length;s++){t=(isNaN(q[s])==false);if(!t){break}}}else{t=(isNaN(w.value)==false)}return t};Alfresco.forms.validation.numberRange=function o(x,r,v,u){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating number range of field '"+x.id+"' using args: "+YAHOO.lang.dump(r))}var t=true;var w=x.value.toString();if(w.length>0){if(isNaN(w)){t=false}else{var s=-1;var q=-1;if(r.min){s=parseInt(r.min)}if(r.minValue){s=parseInt(r.minValue)}if(r.max){q=parseInt(r.max)}if(r.maxValue){q=parseInt(r.maxValue)}if(s!=-1&&w<s){t=false}if(q!=-1&&w>q){t=false}}}return t};Alfresco.forms.validation.nodeName=function l(t,q,s,r){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+t.id+"' is a valid node name")}if(!q){q={}}q.pattern=/([\"\*\\\>\<\?\/\:\|]+)|([\.]?[\.]+$)/;q.match=false;return Alfresco.forms.validation.regexMatch(t,q,s,r)};Alfresco.forms.validation.fileName=function l(v,r,u,t,q,s){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+v.id+"' is a valid node name")}if(!r){r={}}r.pattern=/([\"\*\\\>\<\?\/\:\|]+)|([\.]?[\.]+$)|([ ]?[ ]+$)/;r.match=false;return Alfresco.forms.validation.regexMatch(v,r,u,t,q,s)};Alfresco.forms.validation.wikiTitle=function f(v,r,u,t,q,s){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+v.id+"' is a valid node name")}if(!r){r={}}r.pattern=/([\\\?\/\|]+)|([\.]?[\.]+$)/;r.match=false;return Alfresco.forms.validation.regexMatch(v,r,u,t,q,s)};Alfresco.forms.validation.nodeRef=function m(t,q,s,r){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+t.id+"' is a valid noderef")}if(!q){q={}}q.pattern=/^[^\:^ ]+\:\/\/[^\:^ ]+\/[^ ]+$/;return Alfresco.forms.validation.regexMatch(t,q,s,r)};Alfresco.forms.validation.email=function i(w,s,v,u){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+w.id+"' is a valid email address")}if(!s){s={}}var t=false;if(w.value&&w.value.length>0){var x=w.value.indexOf("<");if(x>=0){x=x+1;var r=w.value.lastIndexOf(">");if(r>x){w.value=w.value.substr(x,(r-x))}}var q=w.value.indexOf('"');if(q==0){s.pattern=/^("[-A-Za-z0-9\(\)<>\[\]\\:,;@\".\" *"!#$%&'*+\/=?^_`{}~|]*")+@([\.A-Za-z0-9_-])*[A-Za-z0-9_-]$/}else{s.pattern=/^([-A-Za-z0-9!#$%&'*+\/=?^_`{}~|]+\.)*[-A-Za-z0-9!#$%&'*+\/=?^_`{}|~_]+@([\.A-Za-z0-9_-])*[A-Za-z0-9_-]$/}s.match=true;t=Alfresco.forms.validation.regexMatch(w,s,v,u)}return t};Alfresco.forms.validation.time=function d(t,q,s,r){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+t.id+"' is a valid time value")}if(!q){q={}}q.pattern=/^([0-1]\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/;q.match=true;return Alfresco.forms.validation.regexMatch(t,q,s,r)};Alfresco.forms.validation.url=function b(v,q,t,s){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+v.id+"' is a valid URL")}var w=/(ftp|http|https):\/\/[\w\-_]+(\.[\w\-_]+)*([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/,r=true;if(v.value.length>0){var u=new RegExp(w);r=v.value.replace(u,"")===""}return r};Alfresco.forms.validation.regexMatch=function n(v,q,t,s){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating regular expression of field '"+v.id+"' using args: "+YAHOO.lang.dump(q))}var r=true;if(v.value&&v.value.length>0){if(q.match===undefined){q.match=true}var u=new RegExp(q.pattern);r=u.test(v.value);if(!q.match){r=!r}}return r};Alfresco.forms.validation.repoRegexMatch=function k(t,q,s,r){q.pattern=q.expression;q.match=q.requiresMatch;return Alfresco.forms.validation.regexMatch(t,q,s,r)};Alfresco.forms.validation.validDateTime=function a(t,q,s,r){if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Validating field '"+t.id+"' has a valid date and time")}return !YAHOO.util.Dom.hasClass(t,"invalid")};Alfresco.forms.validation.inList=function h(t,q,s,r){return true}})();