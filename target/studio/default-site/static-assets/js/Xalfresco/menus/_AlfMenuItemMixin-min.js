define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreRwd","alfresco/menus/_AlfPopupCloseMixin","alfresco/services/_NavigationServiceTopicMixin","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/on","dojo/_base/lang","dojo/_base/event","dojo/query","dojo/NodeList","dojo/NodeList-manipulate"],function(p,h,o,c,a,f,l,d,g,r,m,b,q){return p([h,o,c,a],{cssRequirements:[{cssFile:"./css/_AlfMenuItemMixin.css"}],iconImageWidth:"16px",iconImageHeight:"16px",iconAltText:"",targetUrl:null,targetUrlType:"SHARE_PAGE_RELATIVE",targetUrlLocation:"CURRENT",postMixInProperties:function i(){if(this.label){this.label=this.encodeHTML(this.message(this.label))}this.inherited(arguments)},postCreate:function n(){this.set("label",this.label);this.inherited(arguments);g(this.domNode,"contextmenu",r.hitch(this,"onContextMenu"));if(this.targetUrl!=null){var s;if(typeof this.targetUrlType=="undefined"||this.targetUrlType==null||this.targetUrlType==""||this.targetUrlType==this.sharePageRelativePath){s=Alfresco.constants.URL_PAGECONTEXT+this.targetUrl}else{if(this.targetUrlType==this.contextRelativePath){s=Alfresco.contants.URL_CONTEXT+this.targetUrl}else{if(this.targetUrlType==this.fullPath){s=this.targetUrl}}}this._addAnchors(s)}},_addAnchors:function e(s){dojo.query("td.dijitMenuItemLabel",this.domNode).wrapInner("<a class='alfresco-menus-_AlfMenuItemMixin' href='"+s+"'></a>");dojo.query("span.alf-menu-bar-label-node",this.domNode).wrapInner("<a class='alfresco-menus-_AlfMenuItemMixin' href='"+s+"'></a>")},onContextMenu:function(s){},setupIconNode:function j(){if(this.iconClass&&this.iconClass!="dijitNoIcon"&&this.iconNode){var s=this.iconNode.parentNode;d.empty(s);this.iconNode=d.create("img",{role:"presentation",className:"dijitInline dijitIcon dijitMenuItemIcon "+this.iconClass,src:"/share/res/js/alfresco/menus/css/images/transparent-20.png",alt:this.message(this.iconAltText)},s)}else{if(this.iconImage&&this.iconNode){l.set(this.iconNode,{backgroundImage:"url("+this.iconImage+")",width:this.iconImageWidth,height:this.iconImageHeight,display:"block"})}else{l.set(this.iconNode.parentNode,{width:"auto"})}}},onClick:function k(s){this.alfLog("log","AlfMenuBarItem clicked");this.emitClosePopupEvent();if(this.targetUrl!=null){m.stop(s);this.alfPublish("ALF_NAVIGATE_TO_PAGE",{url:this.targetUrl,type:this.targetUrlType,target:this.targetUrlLocation})}else{if(this.publishTopic!=null){var t=(this.publishPayload)?this.publishPayload:{};this.alfPublish(this.publishTopic,t)}else{this.alfLog("error","An AlfMenuBarItem was clicked but did not define a 'targetUrl' or 'publishTopic' attribute",s)}}}})});